def p(g,u=range,L=len):A=L(g);D=L(g[0]);B=[A for A in u(A)if L(set(g[A]))==1];C=[B for B in u(D)if L(set(g[A][B]for A in u(A)))==1];E=next(E for A in u(A)for(D,E)in enumerate(g[A])if A not in B and D not in C);return[[E]*(L(C)+1)for A in u(L(B)+1)]